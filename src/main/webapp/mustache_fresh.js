(function(f,n){"object"===typeof exports&&exports&&"string"!==typeof exports.nodeName?n(exports):"function"===typeof define&&define.amd?define(["exports"],n):(f.Mustache={},n(f.Mustache))})(this,function(f){function n(a){return"function"===typeof a}function v(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function t(a,c){return null!=a&&"object"===typeof a&&c in a}function p(a,c){function b(a){"string"===typeof a&&(a=a.split(B,2));if(!y(a)||2!==a.length)throw Error("Invalid tags: "+a);
n=new RegExp(v(a[0])+"\\s*");m=new RegExp("\\s*"+v(a[1]));r=new RegExp("\\s*"+v("}"+a[1]))}if(!a)return[];var d=[],e=[],h=[],k=!1,g=!1,n,m,r;b(c||f.tags);for(var q=new w(a),p,l,u,x;!q.eos();){p=q.pos;if(u=q.scanUntil(n)){x=0;for(var t=u.length;x<t;++x)if(l=u.charAt(x),C.call(D,l)?g=!0:h.push(e.length),e.push(["text",l,p,p+1]),p+=1,"\n"===l){if(k&&!g)for(;h.length;)delete e[h.pop()];else h=[];g=k=!1}}if(!q.scan(n))break;k=!0;l=q.scan(E)||"name";q.scan(F);"="===l?(u=q.scanUntil(A),q.scan(A),q.scanUntil(m)):
"{"===l?(u=q.scanUntil(r),q.scan(G),q.scanUntil(m),l="&"):u=q.scanUntil(m);if(!q.scan(m))throw Error("Unclosed tag at "+q.pos);x=[l,u,p,q.pos];e.push(x);if("#"===l||"^"===l)d.push(x);else if("/"===l){l=d.pop();if(!l)throw Error('Unopened section "'+u+'" at '+p);if(l[1]!==u)throw Error('Unclosed section "'+l[1]+'" at '+p);}else"name"===l||"{"===l||"&"===l?g=!0:"="===l&&b(u)}if(l=d.pop())throw Error('Unclosed section "'+l[1]+'" at '+q.pos);return H(I(e))}function I(a){for(var c=[],b,d,e=0,h=a.length;e<
h;++e)if(b=a[e])"text"===b[0]&&d&&"text"===d[0]?(d[1]+=b[1],d[3]=b[3]):(c.push(b),d=b);return c}function H(a){for(var c=[],b=c,d=[],e,h=0,k=a.length;h<k;++h)switch(e=a[h],e[0]){case "#":case "^":b.push(e);d.push(e);b=e[4]=[];break;case "/":b=d.pop();b[5]=e[2];b=0<d.length?d[d.length-1][4]:c;break;default:b.push(e)}return c}function w(a){this.tail=this.string=a;this.pos=0}function r(a,c){this.view=a;this.cache={".":this.view};this.parent=c}function m(){this.cache={}}var J=Object.prototype.toString,
y=Array.isArray||function(a){return"[object Array]"===J.call(a)},C=RegExp.prototype.test,D=/\S/,K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},F=/\s*/,B=/\s+/,A=/\s*=/,G=/\s*\}/,E=/#|\^|\/|>|\{|&|=|!/;w.prototype.eos=function(){return""===this.tail};w.prototype.scan=function(a){a=this.tail.match(a);if(!a||0!==a.index)return"";a=a[0];this.tail=this.tail.substring(a.length);this.pos+=a.length;return a};w.prototype.scanUntil=function(a){a=this.tail.search(a);
var c;switch(a){case -1:c=this.tail;this.tail="";break;case 0:c="";break;default:c=this.tail.substring(0,a),this.tail=this.tail.substring(a)}this.pos+=c.length;return c};r.prototype.push=function(a){return new r(a,this)};r.prototype.lookup=function(a){var c=this.cache,b;if(c.hasOwnProperty(a))b=c[a];else{for(var d=this,e,h,k=!1;d;){if(0<a.indexOf("."))for(b=d.view,e=a.split("."),h=0;null!=b&&h<e.length;)h===e.length-1&&(k=t(b,e[h])),b=b[e[h++]];else b=d.view[a],k=t(d.view,a);if(k)break;d=d.parent}c[a]=
b}n(b)&&(b=b.call(this.view));return b};m.prototype.clearCache=function(){this.cache={}};m.prototype.parse=function(a,c){var b=this.cache,d=b[a];null==d&&(d=b[a]=p(a,c));return d};m.prototype.render=function(a,c,b){var d=this.parse(a);c=c instanceof r?c:new r(c);return this.renderTokens(d,c,b,a)};m.prototype.renderTokens=function(a,c,b,d){for(var e="",h,k,g,f=0,m=a.length;f<m;++f)g=void 0,h=a[f],k=h[0],"#"===k?g=this.renderSection(h,c,b,d):"^"===k?g=this.renderInverted(h,c,b,d):">"===k?g=this.renderPartial(h,
c,b,d):"&"===k?g=this.unescapedValue(h,c):"name"===k?g=this.escapedValue(h,c):"text"===k&&(g=this.rawValue(h)),void 0!==g&&(e+=g);return e};m.prototype.renderSection=function(a,c,b,d){function e(a){return h.render(a,c,b)}var h=this,k="",g=c.lookup(a[1]);if(g){if(y(g))for(var f=0,m=g.length;f<m;++f)k+=this.renderTokens(a[4],c.push(g[f]),b,d);else if("object"===typeof g||"string"===typeof g||"number"===typeof g)k+=this.renderTokens(a[4],c.push(g),b,d);else if(n(g)){if("string"!==typeof d)throw Error("Cannot use higher-order sections without the original template");
g=g.call(c.view,d.slice(a[3],a[5]),e);null!=g&&(k+=g)}else k+=this.renderTokens(a[4],c,b,d);return k}};m.prototype.renderInverted=function(a,c,b,d){var e=c.lookup(a[1]);if(!e||y(e)&&0===e.length)return this.renderTokens(a[4],c,b,d)};m.prototype.renderPartial=function(a,c,b){if(b&&(a=n(b)?b(a[1]):b[a[1]],null!=a))return this.renderTokens(this.parse(a),c,b,a)};m.prototype.unescapedValue=function(a,c){var b=c.lookup(a[1]);if(null!=b)return b};m.prototype.escapedValue=function(a,c){var b=c.lookup(a[1]);
if(null!=b)return f.escape(b)};m.prototype.rawValue=function(a){return a[1]};f.name="mustache.js";f.version="2.2.0";f.tags=["{{","}}"];var z=new m;f.clearCache=function(){return z.clearCache()};f.parse=function(a,c){return z.parse(a,c)};f.render=function(a,c,b){if("string"!==typeof a)throw c=TypeError,a=y(a)?"array":typeof a,new c('Invalid template! Template should be a "string" but "'+a+'" was given as the first argument for mustache#render(template, view, partials)');return z.render(a,c,b)};f.to_html=
function(a,c,b,d){a=f.render(a,c,b);if(n(d))d(a);else return a};f.escape=function(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return K[a]})};f.Scanner=w;f.Context=r;f.Writer=m});var template='<div class="post"><div><h2><a href="/gag?p={{id}}">{{title}} </a></h2></div><div><img src=\'{{imgURL}}\'/></div><p class="stats"><span>{{likes}} points</span>&middot;<span><a href="/gag?p={{id}}"> comments</a></span></p><div class="actions"><div class="actions"><ul class="votes"><li class="btn border"><span class="fa fa-arrow-up"></span></li><li class="btn border"><span class="fa fa-arrow-down"></span></li></ul><ul><li class="btn border"><span class="fa fa-comment"></span></li></ul><ul class="social right"><li class="btn social facebook"><span class="fa fa-facebook" onclick="shareFacebook({{id}});">&nbsp;</span><span class="label">Facebook</span></li><li class="btn social twitter"><span class="fa fa-twitter" onclick="shareTwitter({{id}});">&nbsp;</span><span class="label">Twitter</span></li></ul></div></div></div><hr>';
function refresh(){var f=document.querySelector(".stream"),n=f.querySelector(".post h2 a").getAttribute("href"),v=/.*=([0-9]+)/.exec(n);console.log("\nresult===>"+v);if(v){var n=window.location.protocol+"//"+window.location.host+window.location.pathname,t=v[1],p=new XMLHttpRequest;console.log("currentPostID===>"+t);p.open("GET",n+"?last="+t+"&json",!0);p.onreadystatechange=function(){if(4===p.readyState&&200===p.status)for(var n=JSON.parse(p.responseText),t=0;t<n.length;t++){var w=Mustache.render(template,
n[t]),r=document.createElement("div");r.innerHTML=w;console.log(v);f.insertBefore(r,f.firstChild)}};p.send()}}function autoRefresh(){setInterval(function(){refresh()},5E3)};